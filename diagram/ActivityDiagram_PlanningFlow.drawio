<mxfile host="app.diagrams.net" agent="Claude Code" version="29.2.10">
  <diagram name="Planning Flow Activity Diagram" id="activity-planning-flow">
    <mxGraphModel dx="1800" dy="1300" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1300" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- ==================== TITLE ==================== -->
        <mxCell id="title" value="&lt;b&gt;Activity Diagram: Dự Báo &amp; Lập Kế Hoạch Sản Xuất (Forecast → Planning → MRP)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== SWIMLANES ==================== -->

        <!-- Swimlane: Production Planner -->
        <mxCell id="swimlane_planner" value="&lt;b&gt;Production Planner&lt;/b&gt;" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="80" width="1500" height="200" as="geometry" />
        </mxCell>

        <!-- Swimlane: UIT APS System -->
        <mxCell id="swimlane_system" value="&lt;b&gt;UIT APS System&lt;/b&gt;" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="280" width="1500" height="350" as="geometry" />
        </mxCell>

        <!-- Swimlane: ML Models -->
        <mxCell id="swimlane_ml" value="&lt;b&gt;ML Models&lt;/b&gt;" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="630" width="1500" height="150" as="geometry" />
        </mxCell>

        <!-- Swimlane: ERPNext -->
        <mxCell id="swimlane_erpnext" value="&lt;b&gt;ERPNext&lt;/b&gt;" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="780" width="1500" height="130" as="geometry" />
        </mxCell>

        <!-- ==================== START NODE ==================== -->
        <mxCell id="start" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;strokeColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="100" y="160" width="30" height="30" as="geometry" />
        </mxCell>

        <!-- ==================== PHASE 1: FORECAST ==================== -->

        <!-- Phase Label -->
        <mxCell id="phase1_label" value="&lt;b&gt;PHASE 1: DỰ BÁO (FORECAST)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#b1ddf0;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="160" y="90" width="220" height="25" as="geometry" />
        </mxCell>

        <!-- Activity: Select Forecast Period -->
        <mxCell id="act_select_period" value="Chọn khoảng thời gian&#xa;dự báo&#xa;(Forecast Horizon)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="160" y="140" width="150" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Select ML Model -->
        <mxCell id="act_select_model" value="Chọn ML Model:&#xa;- ARIMA&#xa;- Linear Regression&#xa;- Prophet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="340" y="130" width="130" height="80" as="geometry" />
        </mxCell>

        <!-- Activity: Run Forecast -->
        <mxCell id="act_run_forecast" value="Nhấn&#xa;&quot;Run Forecast&quot;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="500" y="150" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: Load Sales Data -->
        <mxCell id="act_load_sales" value="Tải dữ liệu&#xa;Sales Orders&#xa;lịch sử" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="160" y="320" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Preprocess Data -->
        <mxCell id="act_preprocess" value="Tiền xử lý&#xa;dữ liệu" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="310" y="330" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: Call ML Model -->
        <mxCell id="act_call_ml" value="Gọi ML Model&#xa;để dự báo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="310" y="420" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: ML Predict -->
        <mxCell id="act_ml_predict" value="Chạy dự báo:&#xa;- Tính toán trend&#xa;- Seasonality&#xa;- Confidence interval" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="160" y="680" width="150" height="80" as="geometry" />
        </mxCell>

        <!-- Activity: Save Forecast -->
        <mxCell id="act_save_forecast" value="Lưu kết quả:&#xa;- APS Forecast History&#xa;- APS Forecast Result&#xa;- Accuracy (MAPE%)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="440" y="310" width="150" height="80" as="geometry" />
        </mxCell>

        <!-- Activity: View Forecast -->
        <mxCell id="act_view_forecast" value="Xem kết quả&#xa;dự báo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="620" y="150" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- ==================== PHASE 2: PRODUCTION PLAN ==================== -->

        <!-- Phase Label -->
        <mxCell id="phase2_label" value="&lt;b&gt;PHASE 2: LẬP KẾ HOẠCH (PRODUCTION PLAN)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#b1ddf0;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="730" y="90" width="300" height="25" as="geometry" />
        </mxCell>

        <!-- Decision: Use Forecast? -->
        <mxCell id="decision_use_forecast" value="Dựa trên&#xa;Forecast?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="750" y="135" width="90" height="70" as="geometry" />
        </mxCell>

        <!-- Activity: Create Plan from Forecast -->
        <mxCell id="act_create_from_forecast" value="Tạo Production Plan&#xa;từ Forecast History" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="870" y="120" width="140" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: Create Plan Manual -->
        <mxCell id="act_create_manual" value="Tạo Production Plan&#xa;thủ công&#xa;(Manual / Sales Order)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="870" y="190" width="140" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Define Items -->
        <mxCell id="act_define_items" value="Định nghĩa&#xa;Items &amp; Quantities" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1040" y="150" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: Save Plan -->
        <mxCell id="act_save_plan" value="Lưu APS&#xa;Production Plan&#xa;(status: Draft)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="620" y="320" width="130" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Validate Plan -->
        <mxCell id="act_validate_plan" value="Kiểm tra:&#xa;- Items tồn tại&#xa;- BOM available&#xa;- Quantities hợp lệ" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="770" y="310" width="140" height="80" as="geometry" />
        </mxCell>

        <!-- Decision: Valid? -->
        <mxCell id="decision_valid" value="Hợp&#xa;lệ?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="930" y="320" width="70" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Show Error -->
        <mxCell id="act_show_error" value="Hiển thị&#xa;lỗi" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="930" y="420" width="70" height="40" as="geometry" />
        </mxCell>

        <!-- Activity: Release Plan -->
        <mxCell id="act_release_plan" value="Chuyển status:&#xa;Planned → Released" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1020" y="320" width="130" height="50" as="geometry" />
        </mxCell>

        <!-- ==================== PHASE 3: MRP ==================== -->

        <!-- Phase Label -->
        <mxCell id="phase3_label" value="&lt;b&gt;PHASE 3: MRP (Material Requirement Planning)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#b1ddf0;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1170" y="90" width="340" height="25" as="geometry" />
        </mxCell>

        <!-- Activity: Run MRP -->
        <mxCell id="act_run_mrp" value="Nhấn&#xa;&quot;Run MRP&quot;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1190" y="150" width="90" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: Calculate Requirements -->
        <mxCell id="act_calc_req" value="Tính toán nhu cầu:&#xa;- Explode BOM&#xa;- Gross Requirements&#xa;- Net Requirements" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1170" y="310" width="150" height="80" as="geometry" />
        </mxCell>

        <!-- Activity: Check Stock -->
        <mxCell id="act_check_stock" value="Kiểm tra&#xa;tồn kho hiện tại&#xa;(Stock Levels)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1170" y="420" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Get Stock -->
        <mxCell id="act_get_stock" value="Lấy dữ liệu&#xa;Stock Entry&#xa;Bin levels" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1170" y="820" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Generate Suggestions -->
        <mxCell id="act_gen_suggestions" value="Tạo&#xa;APS Purchase&#xa;Suggestions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1320" y="420" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: View Suggestions -->
        <mxCell id="act_view_suggestions" value="Xem danh sách&#xa;đề xuất mua hàng" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1310" y="150" width="130" height="50" as="geometry" />
        </mxCell>

        <!-- Decision: Create PO? -->
        <mxCell id="decision_create_po" value="Tạo&#xa;PO?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1460" y="145" width="70" height="60" as="geometry" />
        </mxCell>

        <!-- Activity: Create PO -->
        <mxCell id="act_create_po" value="Tạo Purchase&#xa;Orders" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1340" y="310" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- Activity: Save PO ERPNext -->
        <mxCell id="act_save_po" value="Lưu Purchase Orders&#xa;vào ERPNext" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1320" y="820" width="140" height="50" as="geometry" />
        </mxCell>

        <!-- ==================== END NODE ==================== -->
        <mxCell id="end" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;strokeColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1480" y="835" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="end_ring" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=none;strokeColor=#000000;strokeWidth=3;" vertex="1" parent="1">
          <mxGeometry x="1475" y="830" width="40" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== ARROWS ==================== -->

        <!-- Start -> Select Period -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="start" target="act_select_period">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Select Period -> Select Model -->
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_select_period" target="act_select_model">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Select Model -> Run Forecast -->
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_select_model" target="act_run_forecast">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Run Forecast -> Load Sales -->
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_run_forecast" target="act_load_sales">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="550" y="240" />
              <mxPoint x="220" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Load Sales -> Preprocess -->
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_load_sales" target="act_preprocess">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Preprocess -> Call ML -->
        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_preprocess" target="act_call_ml">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Call ML -> ML Predict -->
        <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;strokeColor=#9673a6;" edge="1" parent="1" source="act_call_ml" target="act_ml_predict">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="540" />
              <mxPoint x="235" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- ML Predict -> Save Forecast -->
        <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;strokeColor=#9673a6;" edge="1" parent="1" source="act_ml_predict" target="act_save_forecast">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="235" y="600" />
              <mxPoint x="515" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Save Forecast -> View Forecast -->
        <mxCell id="arrow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_save_forecast" target="act_view_forecast">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="515" y="240" />
              <mxPoint x="670" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- View Forecast -> Decision Use Forecast -->
        <mxCell id="arrow10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_view_forecast" target="decision_use_forecast">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Decision Use Forecast -> Create from Forecast (Yes) -->
        <mxCell id="arrow11" value="Có" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="decision_use_forecast" target="act_create_from_forecast">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Decision Use Forecast -> Create Manual (No) -->
        <mxCell id="arrow12" value="Không" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="decision_use_forecast" target="act_create_manual">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Create from Forecast -> Define Items -->
        <mxCell id="arrow13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_create_from_forecast" target="act_define_items">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Create Manual -> Define Items -->
        <mxCell id="arrow14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_create_manual" target="act_define_items">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Define Items -> Save Plan -->
        <mxCell id="arrow15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_define_items" target="act_save_plan">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1100" y="240" />
              <mxPoint x="685" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Save Plan -> Validate Plan -->
        <mxCell id="arrow16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_save_plan" target="act_validate_plan">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Validate Plan -> Decision Valid -->
        <mxCell id="arrow17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_validate_plan" target="decision_valid">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Decision Valid -> Show Error (No) -->
        <mxCell id="arrow18" value="Không" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="decision_valid" target="act_show_error">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Show Error -> Define Items (back) -->
        <mxCell id="arrow19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;dashed=1;" edge="1" parent="1" source="act_show_error" target="act_define_items">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="965" y="500" />
              <mxPoint x="1100" y="500" />
              <mxPoint x="1100" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Decision Valid -> Release Plan (Yes) -->
        <mxCell id="arrow20" value="Có" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="decision_valid" target="act_release_plan">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Release Plan -> Run MRP -->
        <mxCell id="arrow21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_release_plan" target="act_run_mrp">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1085" y="240" />
              <mxPoint x="1235" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Run MRP -> Calc Requirements -->
        <mxCell id="arrow22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_run_mrp" target="act_calc_req">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Calc Requirements -> Check Stock -->
        <mxCell id="arrow23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_calc_req" target="act_check_stock">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Check Stock -> Get Stock (ERPNext) -->
        <mxCell id="arrow24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;strokeColor=#d6b656;" edge="1" parent="1" source="act_check_stock" target="act_get_stock">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Get Stock -> Gen Suggestions -->
        <mxCell id="arrow25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;strokeColor=#d6b656;" edge="1" parent="1" source="act_get_stock" target="act_gen_suggestions">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1300" y="850" />
              <mxPoint x="1300" y="540" />
              <mxPoint x="1380" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Check Stock -> Gen Suggestions -->
        <mxCell id="arrow26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_check_stock" target="act_gen_suggestions">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Gen Suggestions -> View Suggestions -->
        <mxCell id="arrow27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_gen_suggestions" target="act_view_suggestions">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1380" y="240" />
              <mxPoint x="1375" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- View Suggestions -> Decision Create PO -->
        <mxCell id="arrow28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_view_suggestions" target="decision_create_po">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Decision Create PO -> Create PO (Yes) -->
        <mxCell id="arrow29" value="Có" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="decision_create_po" target="act_create_po">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1495" y="240" />
              <mxPoint x="1390" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Create PO -> Save PO (ERPNext) -->
        <mxCell id="arrow30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;strokeColor=#d6b656;" edge="1" parent="1" source="act_create_po" target="act_save_po">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Save PO -> End -->
        <mxCell id="arrow31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="act_save_po" target="end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Decision Create PO -> End (No) -->
        <mxCell id="arrow32" value="Không" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;" edge="1" parent="1" source="decision_create_po" target="end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1495" y="850" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- ==================== LEGEND ==================== -->
        <mxCell id="legend_box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="50" y="930" width="500" height="120" as="geometry" />
        </mxCell>
        <mxCell id="legend_title" value="&lt;b&gt;CHÚ THÍCH&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="50" y="935" width="500" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend_phase" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b1ddf0;strokeColor=#0e8088;" vertex="1" parent="1">
          <mxGeometry x="70" y="965" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend_phase_text" value="Phase Label (Giai đoạn)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="110" y="960" width="150" height="25" as="geometry" />
        </mxCell>

        <mxCell id="legend_planner" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="70" y="995" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend_planner_text" value="Production Planner Activities" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="110" y="990" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="legend_system" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="70" y="1025" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend_system_text" value="UIT APS System Activities" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="110" y="1020" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="legend_ml" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="300" y="965" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend_ml_text" value="ML Models Activities" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="340" y="960" width="150" height="25" as="geometry" />
        </mxCell>

        <mxCell id="legend_erp" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="300" y="995" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend_erp_text" value="ERPNext Activities" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="340" y="990" width="150" height="25" as="geometry" />
        </mxCell>

        <!-- ==================== NOTES ==================== -->
        <mxCell id="note_box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffc0;strokeColor=#999900;" vertex="1" parent="1">
          <mxGeometry x="580" y="930" width="500" height="120" as="geometry" />
        </mxCell>
        <mxCell id="note_title" value="&lt;b&gt;GHI CHÚ - LUỒNG LẬP KẾ HOẠCH&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="580" y="935" width="500" height="20" as="geometry" />
        </mxCell>
        <mxCell id="note_content" value="• ML Models: ARIMA (time series), Linear Regression (trend), Prophet (Facebook)&#xa;• Forecast Accuracy: MAPE (Mean Absolute Percentage Error) %&#xa;• MRP: Tính toán nhu cầu nguyên vật liệu dựa trên BOM và kế hoạch sản xuất&#xa;• Purchase Suggestions: Nhóm theo Supplier để tạo Purchase Orders&#xa;• Plan Status: Draft → Planned → Released → (Manufacturing Start)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="590" y="960" width="480" height="85" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
